<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport"
              content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
<!--        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css">-->
<!--        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/dist/tabler-icons.min.css" />-->
        <link rel="stylesheet" href="css/tabler-icons.min.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/components.css">
        <script type="module" src="js/script.js" defer></script>
        <script type="module" src="js/components.js" defer></script>
        <script type="module" src="js/game.js" defer></script>
        <script type="module" src="js/online.js" defer></script>
        <title>Tic Tac Toe</title>
    </head>
    <body data-theme="light">
        <div class="theme-switch">
            <label for="theme-switch">
                <input type="checkbox" name="theme" id="theme-switch">
                <div class="slider"></div>
            </label>
        </div>
        <div class="language-select">
            <details class="select language-select" func="changeLanguage">
                <summary>
                    <div class="selected">
                        <img class="flag" src="https://flagsapi.com/GB/flat/32.png" alt="English">
                        <p class="name">English</p>
                    </div>
                </summary>
                <div class="mobile">
                    <div class="options"></div>
                </div>
            </details>
        </div>
        <i class="ti ti-help help-icon" onclick="openHelp()"></i>
        <div class="help hide">
            <section class="blur"></section>
            <section class="dark"></section>
            <section class="content">
                <div class="container">
                    <div class="header">
                        <h2 data-lang="helpHeader">Help</h2>
                        <i class="ti ti-x close-icon" onclick="closeHelp()"></i>
                    </div>
                    <div class="selector help-tab-selector" func="changeHelpTab">
                        <div class="options">
                            <button type="button" class="option active" i="0" val="help-game" data-lang="game">Game</button>
                            <button type="button" class="option" i="1" val="help-local" data-lang="pvpLocal">Local PvP</button>
                            <button type="button" class="option" i="2" val="help-online" data-lang="online">Online</button>
                            <button type="button" class="option" i="3" val="help-bot" data-lang="vsBot">Against Bot</button>
                            <button type="button" class="option" i="4" val="help-about" data-lang="about">About</button>
                        </div>
                    </div>
                    <div class="mobile">
                        <details class="select help-page-select" func="changeHelpTab">
                            <summary>
                                <div class="selected">
                                    <b data-lang="game">English</b>
                                    <i class="ti ti-chevron-down"></i>
                                </div>
                            </summary>
                            <div class="options">
                                <div class="option" val="help-game">
                                    <p data-lang="game"></p>
                                </div>
                                <div class="option" val="help-local">
                                    <p data-lang="pvpLocal"></p>
                                </div>
                                <div class="option" val="help-online">
                                    <p data-lang="online"></p>
                                </div>
                                <div class="option" val="help-bot">
                                    <p data-lang="vsBot"></p>
                                </div>
                                <div class="option" val="help-about">
                                    <p data-lang="about"></p>
                                </div>
                            </div>
                        </details>
                    </div>
                    <div class="help-tab help-game">
                        <div class="article">
                            <h3 data-lang="generalInfo">General Information</h3>
                            <p data-lang="generalInfoContent">
                                Tic-Tac-Toe is a simple yet strategic two-player game played on a 3x3 grid. Players take turns marking a square with their symbol - "X" or "O".
                                The goal is to form a straight line of three of their symbols, either horizontally, vertically, or diagonally.<br><br>

                                Despite its simplicity, the game encourages logical thinking and strategy, as an optimal player can always force a win or a draw. Tic-Tac-Toe
                                is often used as an introduction to game theory and artificial intelligence due to its finite number of possible game states.
                            </p>
                        </div>
                        <div class="article">
                            <h3 data-lang="commonStrategies">Common Strategies</h3>
                            <p data-lang="commonStrategiesContent">
                                While Tic-Tac-Toe is a simple game, mastering it requires strategic thinking. Here are some key strategies to increase your chances of winning:
                            </p>
                            <ul>
                                <li data-lang="cornerOpening">Corner Opening: Always try to start in a corner. This often gives you better chances to create multiple winning lines.</li>
                                <li data-lang="centerControl">Center Control: Taking the center square is a strong move, as it maximizes your options for forming a winning line.</li>
                                <li data-lang="blockingOpponent">Blocking Your Opponent: Always look for your opponent’s potential winning moves and block them before they can complete a row.</li>
                                <li data-lang="forkingStrategy">Forking Strategy: A fork is when you create two possible winning moves at the same time. Your opponent can only block one, leading to your victory.</li>
                                <li data-lang="avoidingLosses">Avoiding Forced Losses: If your opponent gets two marks in a row with an empty space left, you must block it immediately.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="help-tab help-local hide">
                        <div class="article">
                            <h3 data-lang="localPvPMode">Local Player vs Player Mode</h3>
                            <p data-lang="localPvPModeContent">
                                In Local Player vs. Player Mode, two players take turns making moves on the same device. This mode offers flexibility in game settings to customize the experience.<br><br>

                                <b>Game Settings:</b>
                            </p>
                            <ul>
                                <li data-lang="boardSizeDesc">Board Size: Choose a board size between 3×3 and 10×10. Larger boards create longer, more strategic matches.</li>
                                <li data-lang="startingPlayerDesc">Starting Player: Select whether X or O makes the first move. The first player usually has a slight advantage.</li>
                            </ul>
                            <b data-lang="howToPlay">How to Play:</b>
                            <ul>
                                <li data-lang="howToPlay1">Players alternate turns, placing their symbol (X or O) on an empty cell.</li>
                                <li>
                                    <p data-lang="howToPlay2">The objective is to align a specific number of symbols in a row, column, or diagonal:</p>
                                    <ul>
                                        <li data-lang="howToPlay3">For a 3×3 board: Get 3 in a row to win.</li>
                                        <li data-lang="howToPlay4">For larger boards: Get n in a row to win (n is the size of the board).</li>
                                    </ul>
                                </li>
                                <li data-lang="howToPlay5">If the board fills up without a winner, the game ends in a draw.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="help-tab help-online hide">
                        <div class="article">
                            <h3 data-lang="onlinePvPMode">Online Player vs Player Mode</h3>
                            <p data-lang="onlinePvPContent">
                                In Online 1v1 Mode, players can challenge opponents over the internet. You can create or join games and customize settings for an optimal experience.<br><br>

                                <b>Creating a Game</b><br>
                                When creating a game, you can choose from the following visibility options:
                            </p>
                            <ul>
                                <li data-lang="publicDesc">Public: The game appears in the public game list, allowing anyone to join.</li>
                                <li data-lang="unlistedDesc">Unlisted: The game does not appear in the public list, but can be joined via game code or direct URL.</li>
                                <li data-lang="privateDesc">Private: The game requires a password for entry, ensuring only invited players can join.</li>
                            </ul>
                            <p data-lang="onlinePvPContent1">You can also set the starting player as:</p>
                            <ul>
                                <li data-lang="xStart">X (always starts)</li>
                                <li data-lang="oStart">O (always starts)</li>
                                <li data-lang="randomStart">Random (randomly decides who starts)</li>
                            </ul>
                            <p data-lang="afterCreating">
                                After creating a game, you’ll enter the Game Lobby, where the game owner can assign each player’s symbol (X or O) before starting the match.<br><br>

                                <b>Joining a Game</b><br>
                                You can join a game in three ways:
                            </p>
                            <ul>
                                <li data-lang="selectPublicList">Selecting a game from the public list (for public games).</li>
                                <li data-lang="enterGameCode">Entering a game code (for unlisted or private games).</li>
                                <li data-lang="useDirectUrl">Using a direct URL shared by the game creator (currently only for public or unlisted games).</li>
                            </ul>
                            <b data-lang="gameplay">Gameplay</b>
                            <ul>
                                <li data-lang="standardRules">The game follows standard Tic-Tac-Toe rules, with players taking turns to place their symbol on the board.</li>
                                <li data-lang="winCondition">First player to get 3 in a row wins.</li>
                                <li data-lang="drawCondition">If the board fills up with no winner, the game ends in a draw.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="help-tab help-bot hide">
                        <div class="article">
                            <h3 data-lang="playerVsBotMode">Player vs Bot Mode</h3>
                            <p data-lang="playerVsBotContent">
                                In Player vs Bot Mode, you can challenge an AI opponent with different difficulty levels. Customize the game settings and
                                test your skills against increasingly challenging bots!<br><br>

                                <b>Game Settings</b>
                            </p>
                            <ul>
                                <li data-lang="vsBotStarting">Starting Player: You can choose whether you or the bot starts first. The bot always plays as X.</li>
                                <li data-lang="vsBotWinCondition">Win Conditions: First one to get 3 in a row wins.</li>
                            </ul>
                        </div>
                        <div class="article">
                            <h3 data-lang="botDifficultyLevels">Bot Difficulty Levels</h3>
                            <ol>
                                <li data-lang="botDifficultyEasy"><b>Easy (Random)</b> – The bot makes completely random moves, offering little to no challenge.</li>
                                <li>
                                    <p data-lang="botDifficultyMedium"><b>Medium (Basic Strategy)</b> – The bot follows simple rules:</p>
                                    <ul>
                                        <li data-lang="winIfPossible">Win if possible.</li>
                                        <li data-lang="blockOpponentsMove">If winning is not possible, block the opponent’s winning move.</li>
                                        <li data-lang="makeRandomMove">If neither applies, make a random move.</li>
                                    </ul>
                                </li>
                                <li data-lang="botDifficultyImpossible"><b>Impossible (Minimax Algorithm)</b> – The bot uses the Minimax algorithm, which means it plays perfectly and cannot lose.</li>
                                <li data-lang="botDifficultyAI">
                                    <b>AI (Gemini 2.0 Flash Lite)</b> – The bot uses a language Gemini 2.0 Flash Lite model to predict moves, but since it sometimes chooses occupied cells,
                                    it falls back to the Medium bot’s strategy when necessary. This makes the AI a mix of unpredictable and strategic play.
                                </li>
                            </ol>
                        </div>
                        <div class="article">
                            <h3 data-lang="gameplay">Gameplay</h3>
                            <ul>
                                <li data-lang="turnsAlternate">Turns alternate between you and the bot.</li>
                                <li data-lang="botMakesMove">The bot instantly makes its move when it’s its turn.</li>
                                <li data-lang="endsInDraw">If the board fills up with no winner, the game ends in a draw.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="help-tab help-about hide">
                        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusamus amet aperiam, autem blanditiis dolore doloribus eum eveniet, incidunt ipsam laboriosam maxime nobis quas quidem sint sunt temporibus totam velit voluptates!
                    </div>
                </div>
            </section>
        </div>
        <main>
            <h1 data-lang="title">Tic Tac Toe</h1>
            <h2 data-lang="selectMode">Select Mode:</h2>
            <div class="selector mode-selector" func="changeMode">
                <div class="options game-modes">
                    <button type="button" class="option game-mode" i="0" val="local_pvp" data-lang="pvpLocal">PvP (Local)</button>
                    <button type="button" class="option game-mode" i="1" val="online_pvp" data-lang="pvpOnline" disabled>PvP (Online)</button>
                    <button type="button" class="option game-mode" i="2" val="vs_bot" data-lang="vsBot">Against Bot</button>
                </div>
            </div>

            <div class="game-container hidden">
                <div class="game-page local-pvp">
                    <form name="local-pvp-settings">
                        <label for="loc_pvp_size">
                            <h3 data-lang="boardSize">Select the size of the board:</h3>
                        </label>
                        <input type="number" name="size" id="loc_pvp_size" value="3" min="3" max="10" required>
                        <h3 data-lang="startingPlayer">Starting player:</h3>
                        <div class="selector starting-player-selector" func="">
                            <div class="options">
                                <button type="button" class="option active" i="0" val="x">
                                    <i class="ti ti-x"></i>
                                </button>
                                <button type="button" class="option" i="1" val="o">
                                    <i class="ti ti-circle"></i>
                                </button>
                            </div>
                        </div>
                        <button type="button" class="button start-game" onclick="startGame()" data-lang="startGame">Start game</button>
                    </form>
                    <div class="game hide">
                        <div class="turn-text">
                            <h3 data-lang="nowPlaying">Now playing:</h3>
                            <i class="ti icon"></i>
                        </div>
                    </div>
                    <div class="game-over-screen hide">
                        <h3 class="game-over-text"></h3>
                        <button type="button" class="button restart-game" onclick="restartGame('local-pvp')" data-lang="restartGame">Play again</button>
                    </div>
                </div>
                <div class="game-page online-pvp">
                    <div class="game-list">
                        <div class="row header">
                            <button type="button" class="button" onclick="openCreateGame()">
                                <i class="ti ti-plus"></i>
                                <span data-lang="createOnlineGame">Create game</span>
                            </button>
                            <button type="button" class="button" onclick="openJoinGame()">
                                <i class="ti ti-logout"></i>
                                <span data-lang="joinOnlineGame">Join game</span>
                            </button>
                            <button type="button" class="button refresh" onclick="refreshGameList()">
                                <i class="ti ti-refresh"></i>
                            </button>
                        </div>
                        <div class="list"></div>
                    </div>
                    <div class="game-lobby hide">
                        <div class="top">
                            <div class="row">
                                <button type="button" class="button leave-btn" onclick="openLeaveGame()">
                                    <i class="ti ti-login"></i>
                                    <span data-lang="leaveGame">Leave</span>
                                </button>
                            </div>
                            <div class="row game-info">
                                <div class="column">
                                    <h2 class="game-name"></h2>
                                    <div class="row game-uuid">
                                        <p></p>
                                        <i class="ti ti-copy"></i>
                                    </div>
                                </div>
                                <div class="game-code">
                                    <h3></h3>
                                    <i class="ti ti-copy copy-code"></i>
                                </div>
                            </div>
                            <div class="player-list">
                            </div>
                        </div>
                        <div class="bottom">
                            <label for="readySwitch" class="button ready-btn">
                                <span data-lang="ready">Ready</span>
                                <input type="checkbox" name="readySwitch" id="readySwitch">
                            </label>
                        </div>
                    </div>
                    <div class="game-room hide">
                        <div class="row">
                            <button type="button" class="button leave-btn" onclick="openLeaveGame()">
                                <i class="ti ti-login"></i>
                                <span data-lang="leaveGame">Leave</span>
                            </button>
                        </div>
                        <div class="game">
                            <div class="turn-text">
                                <h3 data-lang="nowPlaying">Now playing:</h3>
                                <i class="ti icon"></i>
                            </div>
                            <div class="enemy-thinking-text invisible">
                                <p data-lang="enemyThinking">Enemy is thinking...</p>
                                <div class="loader"></div>
                            </div>
                        </div>
                    </div>
                    <div class="create-game hide">
                        <form name="online-game-settings">
                            <div class="row">
                                <i class="ti ti-chevron-left close-icon" onclick="closeCreateGame()"></i>
                                <h2 data-lang="createOnlineGame">Create game</h2>
                            </div>
                            <label for="gameName">
                                <h3 data-lang="gameName">Game name:</h3>
                            </label>
                            <input type="text" name="gameName" id="gameName" minlength="3" maxlength="20" pattern="/[a-zA-Z0-9 ]+/" required>
                            <h3 data-lang="gameVisibility">Game visibility:</h3>
                            <div class="selector game-visibility-selector" func="changeGameVisibility">
                                <div class="options">
                                    <button type="button" class="option active" i="0" val="public" data-lang="public">Public</button>
                                    <button type="button" class="option" i="1" val="unlisted" data-lang="unlisted">Unlisted</button>
                                    <button type="button" class="option" i="2" val="private" data-lang="private">Private</button>
                                </div>
                            </div>
                            <div class="game-password hide">
                                <label for="gamePassword">
                                    <h3 data-lang="gamePassword">Game password:</h3>
                                </label>
                                <input type="password" name="gamePassword" id="gamePassword" minlength="6" maxlength="20" pattern="/[a-zA-Z0-9!@#$%^&*-_]+/">
                            </div>
                            <h3 data-lang="startingPlayer">Starting player:</h3>
                            <div class="selector starting-player-selector" func="">
                                <div class="options">
                                    <button type="button" class="option" i="0" val="x">
                                        <i class="ti ti-x"></i>
                                    </button>
                                    <button type="button" class="option active" i="1" val="random">
                                        <i class="ti ti-question-mark"></i>
                                    </button>
                                    <button type="button" class="option" i="2" val="o">
                                        <i class="ti ti-circle"></i>
                                    </button>
                                </div>
                            </div>
                            <button type="button" class="button" onclick="createOnlineGame()" data-lang="createOnlineGame">Create game</button>
                        </form>
                    </div>
                    <div class="join-game hide">
                        <form name="join-online-game">
                            <div class="row">
                                <i class="ti ti-chevron-left close-icon" onclick="closeJoinGame()"></i>
                                <h2 data-lang="joinOnlineGame">Join game</h2>
                            </div>
                            <label for="gameCode">
                                <h3 data-lang="gameCode">Game code:</h3>
                            </label>
                            <input type="text" minlength="6" maxlength="6" name="gameCode" id="gameCode" pattern="/[a-zA-Z0-9]+/" required>
                            <div class="game-password hide">
                                <label for="joinPassword">
                                    <h3 data-lang="password">Password:</h3>
                                </label>
                                <input type="password" name="joinPassword" id="joinPassword" minlength="3" maxlength="20">
                            </div>
                            <button type="button" class="button" onclick="joinOnlineGame()" data-lang="joinOnlineGame">Join game</button>
                        </form>
                    </div>
                    <div class="leave-game hide">
                        <div class="dialog">
                            <h3 data-lang="leaveGameConfirm">Are you sure you want to leave the game?</h3>
                            <div class="row">
                                <button type="button" class="button" onclick="leaveGame()" data-lang="yes">Yes</button>
                                <button type="button" class="button" onclick="closeLeaveGame()" data-lang="no">No</button>
                            </div>
                        </div>
                    </div>
                    <div class="game-over-screen hide">
                        <h3 class="game-over-text"></h3>
                        <button type="button" class="button restart-game" data-lang="restartGame">Play again</button>
                        <button type="button" class="button leave-game-btn" data-lang="leaveGame">Leave</button>
                    </div>
                </div>
                <div class="game-page vs-bot">
                    <form name="vs-bot-settings">
                        <h3 data-lang="botDifficulty">Select the difficulty of the bot:</h3>
                        <div class="selector bot-difficulty-selector" func="">
                            <div class="options">
                                <button type="button" class="option active" i="0" val="easy" data-lang="difficultyEasy">Easy</button>
                                <button type="button" class="option" i="1" val="medium" data-lang="difficultyMedium">Medium</button>
                                <button type="button" class="option" i="2" val="impossible" data-lang="difficultyImpossible">Impossible</button>
                                <button type="button" class="option" i="3" val="ai" data-lang="difficultyAI">AI</button>
                            </div>
                        </div>
                        <h3 data-lang="startingPlayer">Starting player:</h3>
                        <div class="selector starting-player-selector" func="">
                            <div class="options">
                                <button type="button" class="option active" i="0" val="x">
                                    <i class="ti ti-x"></i>
                                </button>
                                <button type="button" class="option" i="1" val="o">
                                    <i class="ti ti-circle"></i>
                                </button>
                            </div>
                        </div>
                        <button type="button" class="button start-game" onclick="startGame()" data-lang="startGame">Start game</button>
                    </form>
                    <div class="game hide">
                        <div class="turn-text">
                            <h3 data-lang="nowPlaying">Now playing:</h3>
                            <i class="ti icon"></i>
                        </div>
                        <div class="bot-thinking-text invisible">
                            <p data-lang="enemyThinking">Enemy is thinking...</p>
                            <div class="loader"></div>
                        </div>
                    </div>
                    <div class="game-over-screen hide">
                        <h3 class="game-over-text"></h3>
                        <button type="button" class="button restart-game" onclick="restartGame('vs-bot')" data-lang="restartGame">Play again</button>
                    </div>
                </div>
            </div>
        </main>
        <div class="messages"></div>
    </body>
</html>